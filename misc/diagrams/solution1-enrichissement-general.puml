title Solution 1 - Enrichissement Général par DishAdapter

participant "User" as User
participant "App" as FE
participant "DishAdapter" as DA
participant "restaurant-data.ts" as Data
participant "Menu Service\n:3000" as Menu
participant "Dining Service\n:3001" as Dining

note over FE,Data: === FRONTEND ===
note over Menu,Dining: === BACKEND ===

== Chargement Initial ==

FE -> Menu: **GET /menus**
activate Menu
Menu --> FE: MenuItem[] (6 champs)
deactivate Menu


== Enrichissement ==

FE -> DA: enrichMenuItems(menuItems)
activate DA

DA -> Data: loadEnrichmentData()
activate Data
Data --> DA: EnrichmentMap
deactivate Data


loop Pour chaque MenuItem
  DA -> DA: merger = { ...menuItem, ...enrichmentData }
  
  DA -> DA: Calculs dérivés
end

DA --> FE: Dish[] enrichis (20+ champs)
deactivate DA

== Utilisation pour les Filtres ==

group Filtres Avancés
  FE -> FE: filter par:\n- ingredients[]\n- isVegetarian\n- isVegan\n- isGlutenFree\n- allergens[]\n- cuisine\n- spicyLevel
end

== Validation Commande (General) ==

User -> FE: Valide panier
FE -> Dining: **GET /tableOrders**
note right of FE: Cherche commande active pour la table
Dining --> FE: TableOrder[]
FE -> FE: filter(tableNumber === current && billed === null)

alt Commande existe
  FE -> Dining: **POST /tableOrders/{tableOrderId}**
  Dining --> FE: TableOrder mis a jour
else Pas de commande
  FE -> Dining: **POST /tableOrders**
  Dining --> FE: TableOrder créé
  FE -> Dining: **POST /tableOrders/{tableOrderId}**
  note right of FE:Items commandés passés sur l'Id de la commande
  Dining --> FE: TableOrder avec items
end

FE --> User: Confirmation commande
